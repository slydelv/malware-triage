@echo off
title PC Help Hub Malware Triage Toolkit
if not "%1"=="am_admin" (powershell start -verb runas '%0' am_admin & exit /b)

:setup
set version=0.5
set green=[92m
set white=[0m
set blue=[94m
set black=[30m
set LocalDir=c:\PCHH-Malware-Toolkit
echo Loading PC Help Hub Malware Triage Toolkit...
echo Checking for Chocolatey Package Manager...
IF EXIST "C:\ProgramData\chocolatey\choco.exe" (
    echo %green%Chocolatey already exists, great%white%
) ELSE (
    echo %red%Chocolatey is missing, installing now...%white% (please wait) && @"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))" && SET "PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin"
)
IF EXIST %LocalDir% (
    echo %green%%LocalDir% already exists, great%white%
) ELSE (
    mkdir %LocalDir%
)
timeout /t 2 >nul & cls & goto Intro

:Intro
::chcp 437 >nul
::chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                          Malware Triage Toolkit v%version%
echo %black%..%white%
echo                                                Created by sly#7558
echo                                               for PC Help Hub Discord
echo %black%..%white%
echo                                                  With credits to:
echo                                                    Eduard.#7841
echo %black%..%white%
echo                                        https://github.com/slydelv/malware-triage
echo                                         Recent Changes: Adlice Diag, Roguekiller
timeout /t 5 >nul & cls & goto MainMenu

:MainMenu
::chcp 437 >nul
::chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%MAIN MENU%white%
echo                                                1) Cleaners
echo                                                2) Tools
echo                                                3) AntiVirus / AntiMalware
echo                                                X) Exit
echo %black%..%white%
set /p M="%blue%Choose an option from the menu: %white% "
set choice=%errorlevel%
if %M%==1 goto CleanersMenu
if %M%==2 goto ToolsMenu
if %M%==3 goto AVMenu
if %M%==X goto ExitToolkit
if %M%==x goto ExitToolkit
goto MainMenu

:CleanersMenu
::chcp 437 >nul
::chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%CLEANERS MENU%white%
echo                                                1) MalwareBytes %green%[Working]%white%
echo                                                2) AdwCleaner %green%[Working]%white%
echo                                                3) HitmanPro %green%[Working]%white%
echo                                                4) Emsisoft Emergency Kit [Needs new download method]
echo                                                5) KVRT (Kaspersky Virus Removal Tool) %green%[Working]%white%
echo                                                6) Adlice Diag %green%[Working]%white%
echo                                                7) Adlice Roguekiller
echo                                                B) Back
echo %black%..%white%
set /p M="%blue%Choose an option from the menu: %white% "
set choice=%errorlevel%
if %M%==1 goto InstallMalwareBytes
if %M%==2 goto InstallAdwCleaner
if %M%==3 goto InstallHitmanPro
if %M%==4 goto InstallEmsisoftToolkit
if %M%==5 goto InstallKVRT
if %M%==6 goto InstallAdliceDiag
if %M%==7 goto InstallAdliceRoguekiller
if %M%==B goto MainMenu
if %M%==b goto MainMenu
goto CleanersMenu

:InstallMalwareBytes
echo Malwarebytes crushes the latest threats before others even recognize they exist.
echo Downloading and installing MalwareBytes
choco install malwarebytes /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallAdwCleaner
echo AdwCleaner is an Anti-Adware/Toolbar/PUP/Hijacker search and delete tool
echo Downloading AdwCleaner (Portable)
choco install adwcleaner /y
echo %black%..%white%
echo %black%..%white%
echo Finished download & configuration steps, launching
start C:\ProgramData\chocolatey\bin\adwcleaner.exe
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallHitmanPro
echo HitmanPro is a second opinion scanner, designed to rescue your computer from malware (viruses, trojans, rootkits, etc.)
echo Downloading HitmanPro into %LocalDir% and launching
start /wait powershell -ExecutionPolicy Bypass -Command "$source1 = Invoke-WebRequest -Uri https://www.bleepingcomputer.com/download/hitmanpro/dl/176/ -MaximumRedirection 0;$source2 = $source1.Links | Where-Object {$_.innerText -eq 'click here'} | Select-Object -Expand href;Invoke-WebRequest $source2 -OutFile c:\PCHH-Malware-Toolkit\HitmanPro64.exe;"
echo %black%..%white%
echo %black%..%white%
echo Launching HitmanPro
start %LocalDir%\HitmanPro64.exe
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallEmsisoftToolkit
echo Emsisoft Emergency Kit is a scanner that can be used to scan and clean infected computers.
echo Downloading and installing Emsisoft Emergency Kit
choco install emsisoft-emergency-kit /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallKVRT
echo KVRT is Designed to remove different types of infections from an infected PC
echo Downloading and installing KVRT into %LocalDir%
set kvrt=http://devbuilds.kaspersky-labs.com/devbuilds/KVRT/latest/full/KVRT.exe
start /wait powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri %kvrt% -outfile %LocalDir%\KVRT.exe" 
echo %black%..%white%
echo %black%..%white%
echo Launching KVRT...
start %LocalDir%\KVRT.exe
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallAdliceDiag
echo Diagnose your machine. Detect unknown threats, and eliminate them.
echo Downloading and installing Adlice Diag from %LocalDir%
start /wait powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri 'https://download.adlice.com/api?action=download&app=diag&type=setup' -outfile %LocalDir%\AdliceDiag_setup.exe" 
echo %black%..%white%
echo %black%..%white%
echo Launching Adlice Diag...
start %LocalDir%\AdliceDiag_setup.exe
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallAdliceRoguekiller
echo Diagnose your machine. Detect unknown threats, and eliminate them.
echo Downloading and installing Adlice Roguekiller from %LocalDir%
start /wait powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri 'https://download.adlice.com/api?action=download&app=roguekiller&type=setup' -outfile %LocalDir%\RogueKiller_setup.exe.exe" 
echo %black%..%white%
echo %black%..%white%
echo Launching Adlice Roguekiller...
start %LocalDir%\RogueKiller_setup.exe
timeout /t 5 >nul & cls & goto CleanersMenu

:AVMenu
::chcp 437 >nul
::chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%AV MENU%white%
echo                                                1) Avast Free %blue%[Needs Test to confirm working]%white%
echo                                                2) BitDefender Free %blue%[Needs Test to confirm working]%white%
echo                                                3) Kaspersky Internet Security %blue%[Needs Test to confirm working]%white%
echo                                                4) ESET Internet Security %blue%[Needs Test to confirm working]%white%
echo                                                5) ConfigureDefender (By AndyFul) %green%[Working]%white%
echo                                                B) Back
echo %black%..%white%
set /p M="%blue%Choose an option from the menu: %white% "
set choice=%errorlevel%
if %M%==1 goto InstallAvastFree
if %M%==2 goto InstallBitDefenderFree
if %M%==3 goto InstallKIS
if %M%==4 goto InstallEIS
if %M%==5 goto ConfigureDefender
if %M%==B goto MainMenu
if %M%==b goto MainMenu
goto AVMenu

:ConfigureDefender
echo Downloading ConfigureDefender by AndyFul (https://github.com/AndyFul/ConfigureDefender) 
echo into %LocalDir%...
start /wait powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri https://github.com/AndyFul/ConfigureDefender/raw/master/ConfigureDefender.exe -outfile c:\PCHH-Malware-Toolkit\ConfigureDefender.exe" 
echo Launching...
start %LocalDir%\ConfigureDefender.exe
goto ToolsMenu

:InstallAvastFree
echo Free antivirus software from Avast.
echo Downloading and installing Avast Free
choco install avastfreeantivirus /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto AVMenu

:InstallBitDefenderFree
echo (May not work yet)
echo Downloading and installing BitDefender Free
choco install bitdefenderavfree /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto AVMenu

:InstallKIS
echo Kaspersky Internet Security is Antivirus protection and personal firewall with an anti-spam filter
echo Downloading and installing Kaspersky Internet Security
choco install kis /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto AVMenu

:InstallEIS
echo Comprehensive protection for your digital life
echo Downloading and installing ESET Internet Security
choco install eset-internet-security /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto AVMenu

:ToolsMenu
::chcp 437 >nul
::chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%TOOLS MENU%white%
echo                                                1) Farbar Recovery Scan Tool (FRST) %green%[Working]%white%
echo                                                2) RKill %green%[Working]%white%
echo                                                3) KpRm %blue%[unimplemented]%white%
echo                                                4) AntiVirus Removal Tool %green%[Working]%white%
echo                                                5) 
echo                                                B) Back
echo %black%..%white%
set /p M="%blue%Choose an option from the menu: %white% "
set choice=%errorlevel%
if %M%==1 goto InstallFRST
if %M%==2 goto InstallRKill
if %M%==3 goto ToolsMenu
if %M%==4 goto IntallAntiVirusRemovalTool
if %M%==5 goto ToolsMenu
if %M%==B goto MainMenu
if %M%==b goto MainMenu
timeout /t 5 >nul & cls & goto ToolsMenu

:InstallFRST
echo Using slydelv's FRST-Download-Update tool to download FRST into c:\FRST...
echo (The FRST-Download-Update tool will be in %LocalDir%)
start /wait powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri https://github.com/slydelv/FRST-Download-Update/releases/download/Release/FRST-Download-Update.exe -outfile %LocalDir%\FRST-Download-Update.exe" 
echo Launching...
start %LocalDir%\FRST-Download-Update.exe
timeout /t 5 >nul & cls & goto ToolsMenu

:InstallRKill
echo Downloading and launching Rkill
start /wait powershell -ExecutionPolicy Bypass -Command "$source1 = Invoke-WebRequest -Uri https://www.bleepingcomputer.com/download/rkill/dl/10/ -MaximumRedirection 0;$source2 = $source1.Links | Where-Object {$_.innerText -eq 'click here'} | Select-Object -Expand href;Invoke-WebRequest $source2 -OutFile %LocalDir%\rkill.exe;"
echo Downloaded, launching:
start %LocalDir%\rkill.exe
timeout /t 5 >nul & cls & goto ToolsMenu

:IntallAntiVirusRemovalTool
echo Downloading and launching the AntiVirus Removal tool
echo (To %LocalDir% From antivirus-removal-tool.com)
set AntiVirusRemovalToolURL=https://antivirus-removal-tool.com/download/click.php?id=Antivirus_Removal_Tool
start /wait powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri %AntiVirusRemovalToolURL% -outfile %LocalDir%\AntiVirus_Removal_Tool.zip" 
echo Downloaded, unzipping...
start /wait powershell -command "Expand-Archive %LocalDir%\AntiVirus_Removal_Tool.zip %LocalDir%\AntiVirus_Removal_Tool"
echo Unzipped, launching...
start %LocalDir%\AntiVirus_Removal_Tool\Antivirus_Removal_Tool.exe
timeout /t 5 >nul & cls & goto ToolsMenu

:ExitToolkit
mode 42,5
cls
echo %black%..%white%
echo %black%..%white%       
echo Thanks for using the PCHH!
timeout /t 5 >nul
exit