@echo off
title PC Help Hub Malware Triage Toolkit
if not "%1"=="am_admin" (powershell start -verb runas '%0' am_admin & exit /b)

:setup
set green=[92m
set white=[0m
set blue=[94m
set black=[30m
echo Loading PC Help Hub Malware Triage Toolkit
echo ..
echo ..
echo ..
echo Checking for Chocolatey Package Manager...
IF EXIST "C:\ProgramData\chocolatey\choco.exe" (
    echo %green%Chocolatey exists, great%white%
) ELSE (
    echo %red%Chocolatey is missing, installing now...%white%
    @"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))" && SET "PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin"
)
timeout /t 2 >nul & cls & goto MainMenu

:intro
chcp 437 >nul
chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                     Malware Triage Toolkit
echo %black%..%white%
echo                                      Created by sly#7558
echo                                    for PC Help Hub Discord
echo %black%..%white%
echo                                            Credits:
echo                                          Eduard.#7841
echo %black%..%white%
echo                            https://github.com/slydelv/malware-triage
timeout /t 5 >nul & cls & goto MainMenu

:MainMenu
chcp 437 >nul
chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%MAIN MENU%white%
echo                                                1) Cleaners
echo                                                2) Tools
echo                                                3) AntiVirus / AntiMalware
echo                                                X) Exit
set /p M="%blue%Choose an option from the menu Â»%white% "
set choice=%errorlevel%
if %M%==1 goto CleanersMenu
if %M%==2 goto ToolsMenu
if %M%==3 goto AVMenu
if %M%==X goto ExitToolkit
goto MainMenu

:CleanersMenu
chcp 437>nul
chcp 65001>nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%CLEANERS MENU%white%
echo                                                1) MalwareBytes
echo                                                2) AdwCleaner
echo                                                3) HitmanPro (Second Opinion Scanner)
echo                                                4) Emsisoft Emergency Kit
echo                                                5) KVRT (Kaspersky Virus Removal Tool)
echo                                                B) Back
set /p M="%blue%Choose an option from the menu Â»%white% "
set choice=%errorlevel%
if %M%==1 goto InstallMalwareBytes
if %M%==2 goto InstallAdwCleaner
if %M%==3 goto InstallHitmanPro
if %M%==4 goto InstallEmsisoftToolkit
if %M%==5 goto InstallKVRT
if %M%==B goto MainMenu
goto CleanersMenu

:InstallMalwareBytes
echo Malwarebytes crushes the latest threats before others even recognize they exist.
echo Downloading and installing MalwareBytes
choco install malwarebytes /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallAdwCleaner
echo AdwCleaner is an Anti-Adware/Toolbar/PUP/Hijacker search and delete tool
echo Downloading AdwCleaner (Portable)
choco install adwcleaner /y
echo %black%..%white%
echo %black%..%white%
echo Finished download & configuration steps, launching
start C:\ProgramData\chocolatey\bin\adwcleaner.exe
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallHitmanPro
echo HitmanPro is a second opinion scanner, designed to rescue your computer from malware (viruses, trojans, rootkits, etc.)
echo Downloading and installing HitmanPro
choco install hitmanpro /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallEmsisoftToolkit
echo Emsisoft Emergency Kit is a scanner that can be used to scan and clean infected computers.
echo Downloading and installing Emsisoft Emergency Kit
choco install emsisoft-emergency-kit /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallKVRT
echo KVRT is Designed to remove different types of infections from an infected PC
echo Downloading and installing KVRT
choco install kvrt
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu




:ExitToolkit
mode 42,5
cls
echo %black%..%white%
echo %black%..%white%       
echo Thanks for using the PCHH!
timeout /t 5 >nul
exit