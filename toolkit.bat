@echo off
title PC Help Hub Malware Triage Toolkit
if not "%1"=="am_admin" (powershell start -verb runas '%0' am_admin & exit /b)

:setup
set green=[92m
set white=[0m
set blue=[94m
set black=[30m
echo Loading PC Help Hub Malware Triage Toolkit
echo ..
echo ..
echo ..
echo Checking for Chocolatey Package Manager...
IF EXIST "C:\ProgramData\chocolatey\choco.exe" (
    echo %green%Chocolatey exists, great%white%
) ELSE (
    echo %red%Chocolatey is missing, installing now...%white%
    @"%SystemRoot%\System32\WindowsPowerShell\v1.0\powershell.exe" -NoProfile -InputFormat None -ExecutionPolicy Bypass -Command "iex ((New-Object System.Net.WebClient).DownloadString('https://community.chocolatey.org/install.ps1'))" && SET "PATH=%PATH%;%ALLUSERSPROFILE%\chocolatey\bin"
)
timeout /t 2 >nul & cls & goto MainMenu

:intro
chcp 437 >nul
chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                     Malware Triage Toolkit
echo %black%..%white%
echo                                      Created by sly#7558
echo                                    for PC Help Hub Discord
echo %black%..%white%
echo                                            Credits:
echo                                          Eduard.#7841
echo %black%..%white%
echo                            https://github.com/slydelv/malware-triage
timeout /t 5 >nul & cls & goto MainMenu

:MainMenu
chcp 437 >nul
chcp 65001 >nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%MAIN MENU%white%
echo                                                1) Cleaners
echo                                                2) Tools
echo                                                3) AntiVirus / AntiMalware
echo                                                X) Exit
set /p M="%blue%Choose an option from the menu Â»%white% "
set choice=%errorlevel%
if %M%==1 goto CleanersMenu
if %M%==2 goto ToolsMenu
if %M%==3 goto AVMenu
if %M%==X goto ExitToolkit
goto MainMenu

:CleanersMenu
chcp 437>nul
chcp 65001>nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%CLEANERS MENU%white%
echo                                                1) MalwareBytes
echo                                                2) AdwCleaner
echo                                                3) HitmanPro (Second Opinion Scanner)
echo                                                4) Emsisoft Emergency Kit
echo                                                5) KVRT (Kaspersky Virus Removal Tool)
echo                                                B) Back
set /p M="%blue%Choose an option from the menu Â»%white% "
set choice=%errorlevel%
if %M%==1 goto InstallMalwareBytes
if %M%==2 goto InstallAdwCleaner
if %M%==3 goto InstallHitmanPro
if %M%==4 goto InstallEmsisoftToolkit
if %M%==5 goto InstallKVRT
if %M%==B goto MainMenu
if %M%==b goto MainMenu
goto CleanersMenu

:InstallMalwareBytes
echo Malwarebytes crushes the latest threats before others even recognize they exist.
echo Downloading and installing MalwareBytes
choco install malwarebytes /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallAdwCleaner
echo AdwCleaner is an Anti-Adware/Toolbar/PUP/Hijacker search and delete tool
echo Downloading AdwCleaner (Portable)
choco install adwcleaner /y
echo %black%..%white%
echo %black%..%white%
echo Finished download & configuration steps, launching
start C:\ProgramData\chocolatey\bin\adwcleaner.exe
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallHitmanPro
echo HitmanPro is a second opinion scanner, designed to rescue your computer from malware (viruses, trojans, rootkits, etc.)
echo Downloading and installing HitmanPro
choco install hitmanpro /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallEmsisoftToolkit
echo Emsisoft Emergency Kit is a scanner that can be used to scan and clean infected computers.
echo Downloading and installing Emsisoft Emergency Kit
choco install emsisoft-emergency-kit /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:InstallKVRT
echo KVRT is Designed to remove different types of infections from an infected PC
echo Downloading and installing KVRT
choco install kvrt
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto CleanersMenu

:AVMenu
chcp 437>nul
chcp 65001>nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%AV MENU%white%
echo                                                1) Avast Free
echo                                                2) BitDefender Free
echo                                                3) Kaspersky Internet Security
echo                                                4) ESET Internet Security 
echo                                                5) ConfigureDefender (By AndyFul)
echo                                                B) Back
set /p M="%blue%Choose an option from the menu Â»%white% "
set choice=%errorlevel%
if %M%==1 goto InstallAvastFree
if %M%==2 goto InstallBitDefenderFree
if %M%==3 goto InstallKIS
if %M%==4 goto InstallEIS
if %M%==5 goto ConfigureDefender
if %M%==B goto MainMenu
if %M%==b goto MainMenu
goto AVMenu

:ConfigureDefender
echo Downloading ConfigureDefender by AndyFul (https://github.com/AndyFul/ConfigureDefender) 
echo into c:\PCHH-Malware-Toolkit...
mkdir c:\PCHH-Malware-Toolkit
start /wait powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri https://github.com/AndyFul/ConfigureDefender/raw/master/ConfigureDefender.exe -outfile c:\PCHH-Malware-Toolkit\ConfigureDefender.exe" 
echo Launching...
start c:\PCHH-Malware-Toolkit\ConfigureDefender.exe
goto ToolsMenu

:InstallAvastFree
echo Free antivirus software from Avast.
echo Downloading and installing Avast Free
choco install avastfreeantivirus /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto AVMenu

:InstallBitDefenderFree
echo (May not work)
echo Downloading and installing BitDefender Free
choco install bitdefenderavfree /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto AVMenu

:InstallKIS
echo Kaspersky Internet Security is Antivirus protection and personal firewall with an anti-spam filter
echo Downloading and installing Kaspersky Internet Security
choco install kis /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto AVMenu

:InstallEIS
echo Comprehensive protection for your digital life
echo Downloading and installing ESET Internet Security
choco install eset-internet-security /y
echo %black%..%white%
echo %black%..%white%
echo Finished installation steps, go ahead and launch it
timeout /t 5 >nul & cls & goto AVMenu

:ToolsMenu
chcp 437>nul
chcp 65001>nul
cls
echo %black%..%white%
echo %black%..%white%
echo %green%    ________  ________          ___  ___  _______   ___       ________        ___  ___  ___  ___  ________     
echo     ^|\   __  \^|\   ____\        ^|\  \^|\  \^|\  ___ \ ^|\  \     ^|\   __  \      ^|\  \^|\  \^|\  \^|\  \^|\   __  \    
echo     \ \  \^|\  \ \  \___^|        \ \  \\\  \ \   __/^|\ \  \    \ \  \^|\  \     \ \  \\\  \ \  \\\  \ \  \^|\ /_   
echo      \ \   ____\ \  \            \ \   __  \ \  \_^|/_\ \  \    \ \   ____\     \ \   __  \ \  \\\  \ \   __  \  
echo       \ \  \___^|\ \  \____        \ \  \ \  \ \  \_^|\ \ \  \____\ \  \___^|      \ \  \ \  \ \  \\\  \ \  \^|\  \ 
echo        \ \__\    \ \_______\       \ \__\ \__\ \_______\ \_______\ \__\          \ \__\ \__\ \_______\ \_______\
echo         \^|__^|     \^|_______^|        \^|__^|\^|__^|\^|_______^|\^|_______^|\^|__^|           \^|__^|\^|__^|\^|_______^|\^|_______^|%white%
echo %black%..%white%
echo %black%..%white%
echo                                                %blue%TOOLS MENU%white%
echo                                                1) Farbar Recovery Scan Tool (FRST)
echo                                                2) RKill (unimplemented)
echo                                                3) 
echo                                                4) 
echo                                                5) 
echo                                                B) Back
set /p M="%blue%Choose an option from the menu Â»%white% "
set choice=%errorlevel%
if %M%==1 goto InstallFRST
if %M%==2 goto 
if %M%==3 goto 
if %M%==4 goto 
if %M%==5 goto 
if %M%==B goto MainMenu
if %M%==b goto MainMenu
timeout /t 5 >nul & cls & goto ToolsMenu

:InstallFRST
echo Using slydelv's FRST-Download-Update tool to download FRST into c:\FRST...
echo (The FRST-Download-Update tool will be in c:\PCHH-Malware-Toolkit)
mkdir c:\PCHH-Malware-Toolkit
start /wait powershell -ExecutionPolicy Bypass -Command "Invoke-WebRequest -Uri https://github.com/slydelv/FRST-Download-Update/releases/download/Release/FRST-Download-Update.exe -outfile c:\PCHH-Malware-Toolkit\FRST-Download-Update.exe" 
echo Launching...
start c:\PCHH-Malware-Toolkit\FRST-Download-Update.exe
goto ToolsMenu



:ExitToolkit
mode 42,5
cls
echo %black%..%white%
echo %black%..%white%       
echo Thanks for using the PCHH!
timeout /t 5 >nul
exit